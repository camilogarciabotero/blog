{
  "hash": "bcabd6c5aac57a64bec6981448134e36",
  "result": {
    "markdown": "---\ntitle: \"Population benefited from waste water plants\"\nformat: html\ncategories: [tidytuesday, code, analysis]\ntoc: true\ndate: 2021-09-20\nimage: wwp-image.jpeg\n---\n\n\n# Data importing\n\nAs usual we can read the {tidytuesday} data directly from the source using the associated link:\n\n::: {.cell hash='wastes_cache/html/unnamed-chunk-1_7468f228ccaa3236cea7fffe94f4bfd3'}\n\n```{.r .cell-code}\nraw_data <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-09-20/HydroWASTE_v10.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 58502 Columns: 25\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): WWTP_NAME, COUNTRY, CNTRY_ISO, STATUS, LEVEL\ndbl (20): WASTE_ID, SOURCE, ORG_ID, LAT_WWTP, LON_WWTP, QUAL_LOC, LAT_OUT, L...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n::: {.cell hash='wastes_cache/html/unnamed-chunk-2_0591d00eec6377e06d190d1e41aa0f91'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.0      ✔ stringr 1.4.1 \n✔ readr   2.1.2      ✔ forcats 0.5.1 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n\n# Simple manipulation and visualization\n\n\n::: {.cell hash='wastes_cache/html/unnamed-chunk-3_67f0a19adfda7d181c55b6bcc729dd72'}\n\n```{.r .cell-code}\ncolombian_wastes <- raw_data |> \n  mutate(COUNTRY = as_factor(COUNTRY), WASTE_ID = as_factor(WASTE_ID)) |> \n  filter(COUNTRY == \"Colombia\") |> \n  select(WASTE_ID, POP_SERVED, WASTE_DIS)\n\ncolombian_wastes |> \n  head() |> \n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|WASTE_ID | POP_SERVED| WASTE_DIS|\n|:--------|----------:|---------:|\n|53476    |       1432|    21.784|\n|53679    |       3501|    53.269|\n|53680    |      25142|   382.577|\n|53681    |      42702|   649.783|\n|53682    |      89185|  1357.091|\n|53683    |     332964|  5066.569|\n:::\n:::\n\n::: {.cell hash='wastes_cache/html/unnamed-chunk-4_199637f2f3f69b9d7662ab65e1ad33e7'}\n\n```{.r .cell-code}\nggplot(colombian_wastes) +\n  aes(y = reorder(WASTE_ID, POP_SERVED), x = POP_SERVED) +\n  geom_col() +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](wastes_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n# More advanced stuff\n\n\n::: {.cell hash='wastes_cache/html/unnamed-chunk-5_94370f3e87232b070c748c5e1b34e93a'}\n\n```{.r .cell-code}\nwaste_pairs <- raw_data |> \n  mutate(COUNTRY = as_factor(COUNTRY), WASTE_ID = as_factor(WASTE_ID)) |> \n  filter(COUNTRY %in% c(\"Colombia\", \"Venezuela\")) |> \n  select(COUNTRY, WASTE_ID, POP_SERVED, WASTE_DIS)\n```\n:::\n\n::: {.cell hash='wastes_cache/html/fig-colombia-venezuela_bfa0e98893ee5ecbf42f88ab197906d3'}\n\n```{.r .cell-code}\ntest_result <- statsExpressions::two_sample_test(\n  waste_pairs, \n  COUNTRY, \n  POP_SERVED\n  )\n\nggplot(waste_pairs) +\n  aes(x = COUNTRY, y= POP_SERVED, fill = COUNTRY) +\n  geom_boxplot(outlier.shape = NA) +\n  geom_jitter(width = 0.3, alpha = 0.5, size = 1.2) +\n  ggsignif::geom_signif(\n    comparisons = list(c(\"Colombia\", \"Venezuela\")),\n    map_signif_level = TRUE, textsize = 6\n  ) +\n  labs(\n    title = \"Two-Sample Welch's t-test\",\n    subtitle = parse(text = test_result$expression),\n    x = \"\",\n    y = \"Population served by plant\"\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![Comparisons between Colombian and Venezuelan population benefited from waste water plants](wastes_files/figure-html/fig-colombia-venezuela-1.png){#fig-colombia-venezuela fig-pos='center' width=672}\n:::\n:::\n\n\n# Same as above\n\n\n::: {.cell hash='wastes_cache/html/unnamed-chunk-7_5e0280a13f9bb1ded47a97f5e1ea05f0'}\n\n```{.r .cell-code}\nwaste_pairs <- raw_data |> \n  mutate(COUNTRY = as_factor(COUNTRY), WASTE_ID = as_factor(WASTE_ID)) |> \n  filter(COUNTRY %in% c(\"Germany\", \"Netherlands\")) |> \n  select(COUNTRY, WASTE_ID, POP_SERVED, WASTE_DIS)\n```\n:::\n\n::: {.cell hash='wastes_cache/html/fig-germany-netherlands_814f6cd2a4b723e3ac57480add3bd8d4'}\n\n```{.r .cell-code}\ntest_result <- statsExpressions::two_sample_test(\n  waste_pairs, \n  COUNTRY, \n  POP_SERVED, \n  type = \"nonparametric\"\n  )\n\nggplot(waste_pairs) +\n  aes(x = COUNTRY, y= POP_SERVED, fill = COUNTRY) +\n  geom_boxplot(outlier.shape = NA) +\n  geom_jitter(width = 0.3, alpha = 0.5, size = 1.2) +\n  ggsignif::geom_signif(\n    comparisons = list(c(\"Netherlands\", \"Germany\")),\n    # map_signif_level = TRUE, \n    map_signif_level = \\(p) sprintf(\"p = %.2g\", p),\n    textsize = 6,\n    test = \"wilcox.test\"\n  ) +\n  labs(\n    title = \"Two-Sample Welch's t-test\",\n    subtitle = parse(text = test_result$expression),\n    x = \"\",\n    y = \"Population served by plant\"\n  ) +\n  theme_bw() +\n  theme(\n    legend.position = \"none\"\n  ) +\n  scale_y_log10()\n```\n\n::: {.cell-output-display}\n![Comparisons between German and Dutch population benefited from waste water plants](wastes_files/figure-html/fig-germany-netherlands-1.png){#fig-germany-netherlands fig-pos='center' width=672}\n:::\n:::\n\n\n## Some conclusions\n\nFrom the comparison between Colombia vs Venezuela benefited population from waste water plants [Fig. @fig-colombia-venezuela], there are at least two important highlights. First, both countries display relatively low numbers plants given their extensions (this is something more of an intuition coming from the other comparisons as well), and a second thing is that there is actually no differences regarding the population they are attending. The opposite happens when comparing Germany vs. Netherlands benefited populations [Fig. @fig-germany-netherlands].",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}